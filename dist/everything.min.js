var playersMap={},gameLogic;!function(a){function b(){playersMap[0]="R",playersMap[1]="G",playersMap[2]="Y"}function c(a){switch(a){case 2:return[["#","#","#","#","#","#","#","#","#","","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","","","","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","","","","","","#","#","#","#","#","#","#"],["","","","","","","","","","","","","G","","G","","G","","G"],["#","","","","","","","","","","","","","G","","G","","G","#"],["#","#","","","","","","","","","","","","","G","","G","#","#"],["#","#","#","","","","","","","","","","","","","G","#","#","#"],["#","#","","","","","","","","","","","","","","","","#","#"],["#","","","","","","","","","","","","","","","","","","#"],["","","","","","","R","","R","","R","","R","","","","","",""],["#","#","#","#","#","#","#","R","","R","","R","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","R","","R","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","R","#","#","#","#","#","#","#","#","#"]];case 3:return[["#","#","#","#","#","#","#","#","#","","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","","","","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","","","","","","#","#","#","#","#","#","#"],["Y","","Y","","Y","","Y","","","","","","G","","G","","G","","G"],["#","Y","","Y","","Y","","","","","","","","G","","G","","G","#"],["#","#","Y","","Y","","","","","","","","","","G","","G","#","#"],["#","#","#","Y","","","","","","","","","","","","G","#","#","#"],["#","#","","","","","","","","","","","","","","","","#","#"],["#","","","","","","","","","","","","","","","","","","#"],["","","","","","","R","","R","","R","","R","","","","","",""],["#","#","#","#","#","#","#","R","","R","","R","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","R","","R","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","R","#","#","#","#","#","#","#","#","#"]];default:throw new Error("illegal Player Number: expect 2 or 3")}}function d(a){for(var b="",c=0;c<a.length;c++)for(var d=0;d<a[0].length;d++){var e=a[c][d];b+=""===e?" ":e}var f=["#########R#################R R###############R R R#######. . . R R R R . . .#. . . . . . . . .###. . . . . . . .#####. . . . . . .#####. . . . . . . .###. . . . . . . . .#. . . . . . . . . .#######. . .###############. .#################.#########","#########.#################. .###############. . .#######. . . . . . . . . .#. . . . . . . . .###. . . . . . . .#####G . . . . . .#####G G . . . . . .###G G G . . . . . .#G G G G . . . . . .#######. . .###############. .#################.#########","#########.#################. .###############. . .#######. . . . . . . . . .#. . . . . . . . .###. . . . . . . .#####. . . . . . Y#####. . . . . . Y Y###. . . . . . Y Y Y#. . . . . . Y Y Y Y#######. . .###############. .#################.#########"];for(c=0;c<f.length;c++){var g=f[c],h=new RegExp(g);if(h.test(b))return playersMap[c]}return""}function e(a,b,c){for(var d=[],e=[[0,-2],[-1,-1],[-1,1],[0,2],[1,-1],[1,1]],h=angular.copy(a),i=0;i<e.length;i++){var k=c.rowS+e[i][0],l=c.colS+e[i][1],m={rowS:c.rowS,colS:c.colS,rowE:k,colE:l,playerNo:c.playerNo};try{d.push(j(a,b,m)),g(h,k,l)}catch(n){}}try{var o=f(a,h,e,b,c,c.rowS,c.colS);o&&d.push.apply(d,o)}catch(n){}return d}function f(a,b,c,d,e,i,k){for(var l=[],m=e.rowE,n=e.colE,o=0;o<c.length;o++){var p=m+c[o][0],q=n+c[o][1];try{if(h(a,p,q)){var r=m+2*c[o][0],s=n+2*c[o][1],t={rowS:i,colS:k,rowE:r,colE:s,playerNo:e.playerNo},u=j(b,d,t);if(u){l.push(u),g(b,r,s);var v=f(a,b,c,d,t,i,k);v.length>0&&l.push.apply(l,v)}}}catch(w){}}return l}function g(a,b,c){a[b][c]="@"}function h(a,b,c){return"R"===a[b][c]||"G"===a[b][c]||"Y"===a[b][c]?!0:!1}function i(a,b,c){for(var d=angular.copy(a),e=0;e<a.length;e++)for(var f=0;f<a[0].length;f++)d[e][f]===b&&(d[e][f]=c);return d}function j(a,c,e){if(!a)throw new Error("Board doesn't initial normally");var f=e.rowS,g=e.colS,h=e.rowE,j=e.colE,k=e.playerNo;if(playersMap[c]||b(),0>f||0>g||f>=a.length||g>=a[0].length||0>h||0>j||h>=a.length||j>=a[0].length||"#"===a[f][g]||"#"===a[h][j])throw new Error("Exceed board range");if(""!==a[h][j])throw new Error("One can only make a move in an empty position!");if(""!==d(a))throw new Error("Can only make a move if the game is not over!");var l=i(a,"@","");l[f][g]="",l[h][j]=playersMap[c];var m,n=d(l);return m=""!==n?{endMatch:{endMatchScores:[n===playersMap[0]?1:0,n===playersMap[1]?1:0,n===playersMap[2]?1:0]}}:{setTurn:{turnIndex:(c+1)%k}},[m,{set:{key:"board",value:l}},{set:{key:"delta",value:e}}]}function k(a){var b=a.move,c=a.turnIndexBeforeMove,d=a.stateBeforeMove;try{var e=b[2].set.value,f=d.board,g=(e.playerNo,j(f,c,e));if(!angular.equals(b,g))return!1}catch(h){return!1}return!0}a.initialPLayersMap=b,a.getInitialBoard=c,a.getPossibleMoves=e,a.getPossibleJumpMoves=f,a.createMove=j,a.isMoveOk=k}(gameLogic||(gameLogic={}));var game;!function(a){function b(){console.log("Translation of 'RULES_OF_TICTACTOE' is "+translate("RULES_OF_TICTACTOE")),resizeGameAreaService.setWidthToHeight(1),gameService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:3,isMoveOk:gameLogic.isMoveOk,updateUI:e}),document.addEventListener("animationend",c,!1),document.addEventListener("webkitAnimationEnd",c,!1),document.addEventListener("oanimationend",c,!1)}function c(){$rootScope.$apply(function(){log.info("Animation ended"),k=!0,m&&d()})}function d(){gameService.makeMove(aiService.findComputerMove(n))}function e(a){k=!1,n=a,o=a.stateAfterMove,o.board||(o.board=gameLogic.getInitialBoard(o.delta.playerNo)),l=a.turnIndexAfterMove>=0&&a.yourPlayerIndex===a.turnIndexAfterMove,m=l&&""===a.playersInfo[a.yourPlayerIndex].playerId,m&&(l=!1,o.delta||d())}function f(a,b){if(log.info(["Clicked on cell:",a,b]),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(l)try{var c={rowS:a,colS:b,rowE:0,colE:0,playerNo:o.delta.playerNo},d=gameLogic.createMove(o.board,turnIndex,c);l=!1,gameService.makeMove(d)}catch(e){return void log.info(["Cell is already full in position:",a,b])}}function g(a,b){var c=o.board[a][b];return""!==c}function h(a,b){return"X"===o.board[a][b]}function i(a,b){return"O"===o.board[a][b]}function j(a,b){return!k&&o.delta&&o.delta.rowE===a&&o.delta.colE===b}var k=!1,l=!1,m=!1,n=null,o=null;a.isHelpModalShown=!1,a.init=b,a.cellClicked=f,a.shouldShowImage=g,a.isPieceX=h,a.isPieceO=i,a.shouldSlowlyAppear=j}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["initGameServices",function(){$rootScope.game=game,translate.setLanguage("en",{RULES_OF_TICTACTOE:"Rules of TicTacToe",RULES_SLIDE1:"You and your opponent take turns to mark the grid in an empty spot. The first mark is X, then O, then X, then O, etc.",RULES_SLIDE2:"The first to mark a whole row, column or diagonal wins.",CLOSE:"Close"}),game.init()}]);var aiService;!function(a){function b(a,b,d,e){return c(a,b,d,e)}function c(a,b,c,g){gameLogic.initialPLayersMap();for(var h,i=0,j=[],k=e(a,g),l=d(a,j,k,b,c,g),m=0;m<l.length;m++){for(var n=0,o=(l[m].board,l[m].deltaList),p=0;p<o.length;p++){var q=o[p],r=f(q.rowS,q.colS,q.rowE,q.colE,g);n+=r}n>i&&(i=n,h=o[0])}var s=gameLogic.createMove(a,g,h);return s}function d(a,b,c,e,g,h){if(0==e)return[{board:a,deltaList:angular.copy(b)}];for(var i=[],j=0;j<c.length;j++)for(var k=c[j][0],l=c[j][1],m=gameLogic.getPossibleMoves(a,h,{rowS:k,colS:l,rowE:k,colE:l,playerNo:g}),n=0;n<m.length;n++){var o=m[n],p=o[1].set.value,q=o[2].set.value;if(!(f(q.rowS,q.colS,q.rowE,q.colE,h)<0)){var r=angular.copy(c);r.splice(j,1),r.push([q.rowE,q.colE]),b.push(q);var s=d(p,b,r,e-1,g,h);s&&i.push.apply(i,s),b.splice(-1,1)}}return i}function e(a,b){for(var c=playersMap[b],d=[],e=0;e<a.length;e++)for(var f=0;f<a[0].length;f++)a[e][f]==c&&d.push([e,f]);return d}function f(a,b,c,d,e){var f=parseInt(g[e][a][b]),h=parseInt(g[e][c][d]);return f-h}a.createComputerMove=b;var g=[[["#","#","#","#","#","#","#","#","#","0","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","1","","1","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","2","","2","","2","#","#","#","#","#","#","#"],["6","","5","","4","","3","","3","","3","","3","","4","","5","","6"],["#","6","","5","","4","","4","","4","","4","","4","","5","","6","#"],["#","#","6","","5","","5","","5","","5","","5","","5","","6","#","#"],["#","#","#","6","","6","","6","","6","","6","","6","","6","#","#","#"],["#","#","8","","7","","7","","7","","7","","7","","7","","8","#","#"],["#","10","","9","","8","","8","","8","","8","","8","","9","","10","#"],["12","","11","","10","","9","","9","","9","","9","","10","","11","","12"],["#","#","#","#","#","#","#","10","","10","","10","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","11","","11","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","12","#","#","#","#","#","#","#","#","#"]],[["#","#","#","#","#","#","#","#","#","12","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","10","","11","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","8","","9","","10","#","#","#","#","#","#","#"],["6","","6","","6","","6","","7","","8","","9","","10","","11","","12"],["#","5","","5","","5","","6","","7","","8","","9","","10","","11","#"],["#","#","4","","4","","5","","6","","7","","8","","9","","10","#","#"],["#","#","#","3","","4","","5","","6","","7","","8","","9","#","#","#"],["#","#","2","","3","","4","","5","","6","","7","","8","","10","#","#"],["#","1","","2","","3","","4","","5","","6","","7","","9","","11","#"],["0","","1","","2","","3","","4","","5","","6","","8","","10","","12"],["#","#","#","#","#","#","#","4","","5","","6","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","5","","6","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","6","#","#","#","#","#","#","#","#","#"]],[["#","#","#","#","#","#","#","#","#","12","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","11","","10","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","10","","9","","8","#","#","#","#","#","#","#"],["12","","11","","10","","9","","8","","7","","6","","6","","6","","6"],["#","11","","10","","9","","8","","7","","6","","5","","5","","5","#"],["#","#","10","","9","","8","","7","","6","","5","","4","","4","#","#"],["#","#","#","9","","8","","7","","6","","5","","4","","3","#","#","#"],["#","#","10","","8","","7","","6","","5","","4","","3","","2","#","#"],["#","11","","9","","7","","6","","5","","4","","3","","2","","1","#"],["12","","10","","8","","6","","5","","4","","3","","2","","1","","0"],["#","#","#","#","#","#","#","6","","5","","4","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","6","","5","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","6","#","#","#","#","#","#","#","#","#"]]]}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map